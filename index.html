<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Echoes of Hope</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<style>
body {
  margin:0;
  background:black;
  overflow:hidden;
  touch-action:none;
}
canvas {
  display:block;
  background:#111;
}

/* BOTÃƒO START (SOBRE O JOGO) */
#startOverlay {
  position:fixed;
  inset:0;
  background:black;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:10;
}

#startBtn {
  padding:20px 40px;
  font-size:22px;
  background:#111;
  color:white;
  border:2px solid white;
}

/* CONTROLES MOBILE */
#controls {
  position:fixed;
  bottom:10px;
  left:0;
  right:0;
  display:flex;
  justify-content:space-between;
  padding:10px;
  z-index:5;
}
.btn {
  width:70px;
  height:70px;
  background:#222;
  color:white;
  font-size:24px;
  border-radius:50%;
  text-align:center;
  line-height:70px;
  user-select:none;
}
</style>
</head>

<body>

<div id="startOverlay">
  <button id="startBtn">INICIAR</button>
</div>

<canvas id="game"></canvas>

<div id="controls">
  <div class="btn" id="left">â—€</div>
  <div class="btn" id="right">â–¶</div>
  <div class="btn" id="attack">ðŸ”¥</div>
</div>

<script>
/* ===== CANVAS ===== */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

function resize(){
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resize();
window.addEventListener("resize", resize);

/* ===== INPUT ===== */
let keys = {};
document.addEventListener("keydown", e => keys[e.key] = true);
document.addEventListener("keyup", e => keys[e.key] = false);

document.getElementById("left").ontouchstart = () => keys["ArrowLeft"] = true;
document.getElementById("left").ontouchend   = () => keys["ArrowLeft"] = false;
document.getElementById("right").ontouchstart = () => keys["ArrowRight"] = true;
document.getElementById("right").ontouchend   = () => keys["ArrowRight"] = false;
document.getElementById("attack").ontouchstart = () => keys[" "] = true;
document.getElementById("attack").ontouchend   = () => keys[" "] = false;

/* ===== GAME STATE ===== */
let state = "menu";
let cameraX = 0;

let player = { x:100, life:100, attack:10, speed:2, fury:false };
let dog = { alive:true };
let zombies = [];
let bullets = [];
let boss = { x:2000, life:300 };

/* START */
document.getElementById("startBtn").onclick = () => {
  state = "game";
  document.getElementById("startOverlay").style.display = "none";
};

/* PC ENTER */
document.addEventListener("keydown", e=>{
  if(e.key==="Enter" && state==="menu"){
    state="game";
    document.getElementById("startOverlay").style.display="none";
  }
});

/* ===== LOOP ===== */
function loop(){
  if(state==="game") updateGame();
  if(state==="boss") updateBoss();
  if(state==="end") drawEnd();
  requestAnimationFrame(loop);
}

/* ===== GAME ===== */
function spawnZombie(){
  zombies.push({ x:cameraX + canvas.width + 50, life:30 });
}

function updateGame(){
  cameraX += player.speed;

  if(keys["ArrowLeft"]) player.x -= 3;
  if(keys["ArrowRight"]) player.x += 3;
  if(keys[" "]) bullets.push({ x:player.x + 20 });

  bullets.forEach(b => b.x += 6);
  if(Math.random()<0.02) spawnZombie();

  zombies.forEach(z=>{
    z.x -= 1;
    if(z.x < cameraX + player.x + 20){
      player.life -= 0.1;
    }
  });

  bullets.forEach(b=>{
    zombies.forEach(z=>{
      if(b.x > z.x && b.x < z.x + 20){
        z.life -= player.attack;
      }
    });
  });

  zombies = zombies.filter(z=>z.life>0);

  if(cameraX>1500) state="boss";
  drawWorld();
}

function updateBoss(){
  if(dog.alive){
    dog.alive=false;
    player.fury=true;
    player.attack=30;
    player.speed=3;
  }

  if(keys[" "]) boss.life -= player.attack*0.1;
  drawWorld();

  ctx.fillStyle="darkred";
  ctx.fillRect(boss.x-cameraX, canvas.height-180, 80,120);
  ctx.fillStyle="white";
  ctx.fillText("BOSS VIDA: "+Math.floor(boss.life),20,40);

  if(boss.life<=0) state="end";
}

/* ===== DRAW ===== */
function drawWorld(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle="#1a1a1a";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  ctx.fillStyle="#2e2e2e";
  for(let i=0;i<20;i++){
    ctx.fillRect((i*200-cameraX*0.3)%2000, canvas.height-350,80,250);
  }

  ctx.fillStyle="#333";
  ctx.fillRect(0,canvas.height-80,canvas.width,80);

  ctx.fillStyle=player.fury?"red":"white";
  ctx.fillRect(player.x, canvas.height-100,20,20);

  if(dog.alive){
    ctx.fillStyle="brown";
    ctx.fillRect(player.x-25, canvas.height-95,15,10);
  }

  ctx.fillStyle="green";
  zombies.forEach(z=>{
    ctx.fillRect(z.x-cameraX, canvas.height-100,20,20);
  });

  ctx.fillStyle="yellow";
  bullets.forEach(b=>{
    ctx.fillRect(b.x-cameraX, canvas.height-90,5,2);
  });

  ctx.fillStyle="white";
  ctx.fillText("Vida: "+Math.floor(player.life),10,20);
}

function drawEnd(){
  ctx.fillStyle="black";
  ctx.fillRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle="white";
  ctx.font="18px monospace";
  let txt=[
    "A cidade caiu.",
    "Seu companheiro morreu.",
    "Mas vocÃª venceu.",
    "",
    "Criado por:",
    "Jonathan Pereira"
  ];
  txt.forEach((t,i)=>{
    ctx.fillText(t, canvas.width/2-170, canvas.height/2-80+i*30);
  });
}

loop();
</script>
</body>
</html>
